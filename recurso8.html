<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>RECURSO8</title>
    <style>
        body,
        input,
        button,
        select {
            font-size: 24px;
            color: black;
        }
        
        input,
        p,
        button,
        select {
            margin-bottom: 40px;
        }
        
        div {
            width: 90%;
            border: dotted;
            margin-bottom: 20px;
            text-align: center;
            margin-right: auto;
            margin-left: auto;
        }
        
        #j1-div {
            background-color: #34e0ba;
        }
        
        #j-div {
            background-color: gold;
        }
        
        #j2-div {
            background-color: #4d5edd;
        }
    </style>
</head>

<body>
    <h1>RECURSO8: JUEGO DEL AHORCADO</h1>
    <h2>DESARROLLADOR: LUIS VALLES PASTOR</h2>
    <div id="j1-div">
        <h2>JUGADOR 1</h2>
        <input id="palabra-input" type="password" placeholder="Introduzca una palabra" size=20>
        <button id="j1-b">INTRODUCIR</button>
    </div>
    <div id="j-div">
        <h2>JUEGO</h2>
        <h3>N&Uacute;MERO DE INTENTOS:</h3>
        <p id="intentos-p">-</p>
        <h3>LETRAS SELECCIONADAS:</h3>
        <p id="letras-p">-</p>
        <h3>OCULTA:</h3>
        <p id="oculta-p">-</p>
    </div>
    <div id="j2-div">
        <h2>JUGADOR 2</h2>
        <label>Seleccione una letra</label>
        <select id="letras-select"></select>
        <button id="j2-b1">SELECCIONAR</button>
        <br>
        <input id="solucion-input" type="text" placeholder="Introduzca su solución" size=20>
        <button id="j2-b2">INTRODUCIR</button>
    </div>
    <script type="application/javascript">
        function inicioAhorcado() {
            document.getElementById("j-div").style.display = "none";
            document.getElementById("j2-div").style.display = "none";
            rellenarSelect();
        }

        function rellenarSelect() {
            for (let i = 65; i <= 90; i++) {
                var option = document.createElement("option");
                option.textContent = String.fromCharCode(i);
                option.value = String.fromCharCode(i);
                document.getElementById("letras-select").options.add(option);
            }
            var option = document.createElement("option");
            option.textContent = 'Ñ';
            option.value = 'Ñ';
            document.getElementById("letras-select").options.add(option);
        }

        function ganarAhorcado() {
            alert("¡Enhorabuena! ¡Ha ganado!");
            document.getElementById("oculta-p").style.backgroundColor = "green";
            finAhorcado();
        }

        function perderAhorcado() {
            alert("Oh, ha perdido ¡pruebe más suerte la próxima vez!");
            document.getElementById("oculta-p").style.backgroundColor = "red";
            finAhorcado();
        }

        function finAhorcado() {
            document.getElementById("oculta-p").style.color = "#f5f5f5";
            document.getElementById("letras-select").disabled = true;
            document.getElementById("j2-b1").disabled = true;
            document.getElementById("solucion-input").disabled = true;
            document.getElementById("j2-b2").disabled = true;
            document.getElementById("oculta-p").textContent = document.getElementById("palabra-input").value.toUpperCase();
        }

        inicioAhorcado();

        document.getElementById("j1-b").addEventListener("click", event => {
            var valor_palabra = document.getElementById("palabra-input").value.toUpperCase();
            var expresion = /[A-Z]$/;
            if (valor_palabra != "" && expresion.test(valor_palabra)) {
                // No admite la Ñ
                // document.getElementById("oculta-p").textContent = valor_palabra.replace(/\w/g, "_ ");
                document.getElementById("oculta-p").textContent = "";
                for (let i = 0; i < valor_palabra.length; i++) {
                    document.getElementById("oculta-p").textContent += "_ ";
                }
                document.getElementById("j1-div").style.display = "none";
                document.getElementById("j-div").style.display = "block";
                document.getElementById("j2-div").style.display = "block";
            } else {
                if (valor_palabra == "")
                    alert("Error: El campo está vacío");
                else alert("Error: El campo sólo admite letras de la A-Z sin acentos");
            }
        });

        var contador = 5;
        document.getElementById("intentos-p").textContent = contador;
        var vector_letras = [];
        document.getElementById("j2-b1").addEventListener("click", event => {
            var valor_palabra = document.getElementById("palabra-input").value.toUpperCase();
            var vector = valor_palabra.split("");
            var letra = document.getElementById("letras-select").value;
            if (!vector_letras.includes(letra)) {
                vector_letras.push(letra);
                --contador;
                if (vector.includes(letra)) {
                    document.getElementById("oculta-p").textContent = "";
                    for (let i = 0; i < valor_palabra.length; i++) {
                        if (vector_letras.includes(valor_palabra.charAt(i))) {
                            document.getElementById("oculta-p").textContent += valor_palabra.charAt(i) + " ";
                        } else {
                            document.getElementById("oculta-p").textContent += "_ ";
                        }
                    }
                    var aux = document.getElementById("oculta-p").textContent.replaceAll(" ", "");
                    if (aux == valor_palabra) {
                        ganarAhorcado();
                        // Finalizo la función
                        // return;
                    }
                }
            } else {
                alert("Ya ha seleccionado esa letra");
            }
            if (contador == 0) {
                alert("Se ha quedado sin intentos");
                document.getElementById("letras-select").disabled = true;
                document.getElementById("j2-b1").disabled = true;
            }
            document.getElementById("letras-p").textContent = vector_letras.toString();
            document.getElementById("intentos-p").textContent = contador;
        });

        document.getElementById("j2-b2").addEventListener("click", event => {
            alert("Desde esta opción solo posee un intento para ganar, haga click derecho sobre el botón 'INTRODUCIR' para confirmar");
        });

        document.getElementById("j2-b2").addEventListener("contextmenu", event => {
            var solucion = document.getElementById("solucion-input").value.toUpperCase();
            if (solucion != "") {
                if (solucion == document.getElementById("palabra-input").value.toUpperCase()) {
                    ganarAhorcado();
                } else {
                    perderAhorcado();
                }
            } else {
                alert("El campo está vacío");
            }
            // Para deshabilitar el menú contextual
            document.oncontextmenu = function() {
                return false;
            };
        });
    </script>

</body>

</html>